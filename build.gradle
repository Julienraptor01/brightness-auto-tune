import static org.gradle.api.JavaVersion.VERSION_17

plugins {
	id 'fabric-loom' version '0.11-SNAPSHOT'
	id 'maven-publish'
}

sourceCompatibility = VERSION_17
targetCompatibility = VERSION_17

repositories {}

dependencies {
	/*
	 * Fabric API.
	 *
	 * This is technically optional, but you probably want it anyway.
	 */
	modImplementation "net.fabricmc.fabric-api:fabric-api:${fabric_version}"

	// Fabric Loader
	modImplementation "net.fabricmc:fabric-loader:${loader_version}"

	// Mappings - Official Mojang Mappings
	mappings loom.officialMojangMappings()

	// Minecraft
	minecraft "com.mojang:minecraft:${minecraft_version}"
}

processResources {
	inputs.property 'version', version

	filesMatching 'fabric.mod.json', {
		expand 'loader_version': loader_version,
		       'minecraft_version': minecraft_version,
		       'version': version
	}
}

tasks.withType(JavaCompile).configureEach {
	// Minecraft 1.18 (1.18-pre2) upwards uses Java 17.
	it.options.release = 17
}

java {
	/*
	 * Loom will automatically attach sourcesJar to a RemapSourcesJar task and
	 * to the "build" task if it is present.
	 *
	 * If you remove this line, sources will not be generated.
	 */
	withSourcesJar()
}

jar {
	from 'LICENSE', {
		rename { "${it}_${project.archivesBaseName}" }
	}
}

/*
 * Maven publication configuration.
 */
publishing {
	publications {
		mavenJava MavenPublication, {
			from components.java
		}
	}

	/*
	 * See https://docs.gradle.org/current/userguide/publishing_maven.html for
	 *
	 * information on how to set up publishing.
	 */
	repositories {
		/*
		 * Add repositories to publish to here.
		 *
		 * Notice: This block does NOT have the same function as the block in
		 *         the top level.
		 *
		 * The repositories here will be used for publishing your artifact, not
		 * for retrieving dependencies.
		 */
	}
}
